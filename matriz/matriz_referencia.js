// Matriz de Referência - Dados das Habilidades
// Baseado no arquivo matriz_referencia.json

const matrizReferencia = {
    "Língua Portuguesa - Leitura": {
        "6º ano": [
            {
                "codigo": "6EF01_P",
                "descricao": "Localizar informação em textos de nível 2, quando a informação é retomada por um processo de referenciação com referente próximo.",
                "bncc": "EF15LP03",
                "ciclos": ["Ciclo I"]
            },
            {
                "codigo": "6EF02_P",
                "descricao": "Localizar informações explícitas em textos de nível 2 recuperando-as por meio de paráfrase estando a informação no início do texto.",
                "bncc": "EF69LP03",
                "ciclos": ["Ciclo II", "Ciclo III"]
            },
            {
                "codigo": "6EF03_P",
                "descricao": "Inferir informação em textos de nível 2 com base em elementos verbais e não verbais.",
                "bncc": "EF15LP04",
                "ciclos": ["Ciclo I"]
            },
            {
                "codigo": "6EF04_P",
                "descricao": "Distinguir fato de opinião em textos argumentativos.",
                "bncc": "EF69LP04",
                "ciclos": ["Ciclo II"]
            }
        ],
        "7º ano": [
            {
                "codigo": "7EF01_P",
                "descricao": "Localizar informações explícitas em textos de nível 3, recuperando-as por meio de paráfrase estando a informação no início do texto.",
                "bncc": "EF69LP03",
                "ciclos": ["Ciclo II"]
            },
            {
                "codigo": "7EF02_P",
                "descricao": "Inferir o sentido de palavra ou expressão a partir do contexto.",
                "bncc": "EF67LP34",
                "ciclos": ["Ciclo II"]
            },
            {
                "codigo": "7EF03_P",
                "descricao": "Identificar a finalidade de textos de diferentes gêneros.",
                "bncc": "EF69LP07",
                "ciclos": ["Ciclo II", "Ciclo III"]
            }
        ],
        "8º ano": [
            {
                "codigo": "8EF01_P",
                "descricao": "Analisar relações entre partes de um texto, identificando repetições ou substituições.",
                "bncc": "EF69LP06",
                "ciclos": ["Ciclo II", "Ciclo III"]
            },
            {
                "codigo": "8EF02_P",
                "descricao": "Interpretar texto com auxílio de material gráfico diverso.",
                "bncc": "EF69LP05",
                "ciclos": ["Ciclo II"]
            }
        ],
        "9º ano": [
            {
                "codigo": "9EF01_P",
                "descricao": "Estabelecer relações lógico-discursivas presentes no texto, marcadas por conjunções, advérbios, etc.",
                "bncc": "EF89LP34",
                "ciclos": ["Ciclo III"]
            },
            {
                "codigo": "9EF02_P",
                "descricao": "Identificar efeitos de ironia ou humor em textos variados.",
                "bncc": "EF89LP35",
                "ciclos": ["Ciclo III"]
            }
        ]
    },
    "Matemática": {
        "6º ano": [
            {
                "codigo": "6EF01_M",
                "descricao": "Corresponder números racionais positivos em representação decimal finita a pontos da reta numérica.",
                "bncc": "EF05MA05",
                "ciclos": ["Ciclo I", "Ciclo II"]
            },
            {
                "codigo": "6EF02_M",
                "descricao": "Comparar números racionais positivos em representação fracionária indicando o menor, o maior, a ordenação crescente ou decrescente.",
                "bncc": "EF05MA05",
                "ciclos": ["Ciclo I", "Ciclo II"]
            },
            {
                "codigo": "6EF03_M",
                "descricao": "Resolver problema que envolva variação proporcional, direta ou inversa, entre grandezas.",
                "bncc": "EF06MA13",
                "ciclos": ["Ciclo II"]
            },
            {
                "codigo": "6EF04_M",
                "descricao": "Calcular a área de figuras planas pela decomposição e/ou composição em figuras de áreas conhecidas.",
                "bncc": "EF06MA29",
                "ciclos": ["Ciclo II"]
            }
        ],
        "7º ano": [
            {
                "codigo": "7EF01_M",
                "descricao": "Efetuar cálculos com números inteiros envolvendo as operações.",
                "bncc": "EF07MA04",
                "ciclos": ["Ciclo II"]
            },
            {
                "codigo": "7EF02_M",
                "descricao": "Resolver problema que envolva porcentagem.",
                "bncc": "EF07MA02",
                "ciclos": ["Ciclo II"]
            },
            {
                "codigo": "7EF03_M",
                "descricao": "Interpretar e resolver situações que envolvam equações do 1º grau.",
                "bncc": "EF07MA18",
                "ciclos": ["Ciclo II"]
            }
        ],
        "8º ano": [
            {
                "codigo": "8EF01_M",
                "descricao": "Efetuar cálculos com potências de expoentes inteiros.",
                "bncc": "EF08MA01",
                "ciclos": ["Ciclo III"]
            },
            {
                "codigo": "8EF02_M",
                "descricao": "Resolver sistema de equações do 1º grau com duas incógnitas.",
                "bncc": "EF08MA08",
                "ciclos": ["Ciclo III"]
            }
        ],
        "9º ano": [
            {
                "codigo": "9EF01_M",
                "descricao": "Resolver problemas que envolvam relações métricas no triângulo retângulo.",
                "bncc": "EF09MA14",
                "ciclos": ["Ciclo III"]
            },
            {
                "codigo": "9EF02_M",
                "descricao": "Resolver equação do 2º grau utilizando procedimentos diversos.",
                "bncc": "EF09MA09",
                "ciclos": ["Ciclo III"]
            }
        ]
    },
    "Ciências da Natureza": {
        "6º ano": [
            {
                "codigo": "6EF01_CN",
                "descricao": "Interpretar o ciclo da água.",
                "bncc": "EF05CI02",
                "ciclos": ["Ciclo I"]
            },
            {
                "codigo": "6EF02_CN",
                "descricao": "Explicar como a ação da água, atividade dos seres vivos e a retirada de cobertura vegetal influenciam no processo de erosão.",
                "bncc": "EF05CI03",
                "ciclos": ["Ciclo I"]
            },
            {
                "codigo": "6EF03_CN",
                "descricao": "Classificar a diversidade dos seres vivos com base em características observáveis.",
                "bncc": "EF06CI02",
                "ciclos": ["Ciclo II"]
            }
        ],
        "7º ano": [
            {
                "codigo": "7EF01_CN",
                "descricao": "Caracterizar os principais ecossistemas brasileiros quanto à paisagem, quantidade de água, ao tipo de solo.",
                "bncc": "EF07CI07",
                "ciclos": ["Ciclo II"]
            },
            {
                "codigo": "7EF02_CN",
                "descricao": "Interpretar as condições de saúde da comunidade, cidade ou estado, com base na análise e comparação de indicadores.",
                "bncc": "EF07CI09",
                "ciclos": ["Ciclo II"]
            }
        ],
        "8º ano": [
            {
                "codigo": "8EF01_CN",
                "descricao": "Identificar os principais órgãos e funções dos sistemas do organismo humano.",
                "bncc": "EF08CI02",
                "ciclos": ["Ciclo III"]
            }
        ],
        "9º ano": [
            {
                "codigo": "9EF01_CN",
                "descricao": "Identificar modelos que descrevem a estrutura da matéria.",
                "bncc": "EF09CI01",
                "ciclos": ["Ciclo III"]
            }
        ]
    }
};

// Função para obter habilidades por filtros
function getHabilidades(disciplina = null, ano = null) {
    let resultado = [];
    
    for (const [disc, anos] of Object.entries(matrizReferencia)) {
        if (disciplina && disc !== disciplina) continue;
        
        for (const [anoEscolar, habilidades] of Object.entries(anos)) {
            if (ano && anoEscolar !== `${ano}º ano`) continue;
            
            habilidades.forEach(habilidade => {
                resultado.push({
                    ...habilidade,
                    disciplina: disc,
                    ano: anoEscolar
                });
            });
        }
    }
    
    return resultado;
}

// Função para buscar habilidades por texto
function searchHabilidades(termo) {
    const termoLower = termo.toLowerCase();
    return getHabilidades().filter(habilidade => 
        habilidade.descricao.toLowerCase().includes(termoLower) ||
        habilidade.codigo.toLowerCase().includes(termoLower) ||
        habilidade.bncc.toLowerCase().includes(termoLower)
    );
}

// Função para obter estatísticas das matrizes
function getMatrizStats() {
    const stats = {
        totalHabilidades: 0,
        porDisciplina: {},
        porAno: {},
        porCiclo: {}
    };
    
    for (const [disciplina, anos] of Object.entries(matrizReferencia)) {
        stats.porDisciplina[disciplina] = 0;
        
        for (const [ano, habilidades] of Object.entries(anos)) {
            stats.totalHabilidades += habilidades.length;
            stats.porDisciplina[disciplina] += habilidades.length;
            
            if (!stats.porAno[ano]) stats.porAno[ano] = 0;
            stats.porAno[ano] += habilidades.length;
            
            habilidades.forEach(habilidade => {
                habilidade.ciclos.forEach(ciclo => {
                    if (!stats.porCiclo[ciclo]) stats.porCiclo[ciclo] = 0;
                    stats.porCiclo[ciclo]++;
                });
            });
        }
    }
    
    return stats;
}
